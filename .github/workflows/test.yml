name: test

on:
  workflow_dispatch:
  push:
    tags:
      - "*"

jobs:
  build:
    name: Build ${{ matrix.arch }}
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      matrix:
        arch:
          - aarch64_generic

    permissions:
      actions: write
      contents: write
      
    steps:
      - name: Organize files
        run: |
          # 创建存放目录
          mkdir -p makeself
          
          echo "Hello, World!" > makeself/hello.run
          
          ls makeself

      - name: Commit and push changes
        run: |  
          cd makeself
          git config --global user.name "GitHub Actions"
          git config --global user.email "uiouio_001@163.com"
          
          git init
          #添加makeself目录下所有.run文件到缓冲区
          git add *.run
          #提交信息
          git commit -m "Automated make .run files"
          git remote add origin git@github.com:uiouio001/luci.git
          #推送到指定目录
          if [ "${{ matrix.arch }}" = "aarch64_generic" ]; then
            git push -u origin main:/run/arm64
          else
            git push -u origin main:/run/x86
          fi

          

