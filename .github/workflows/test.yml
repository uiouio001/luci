name: test

on:
  workflow_dispatch:

jobs:
  build:
    name: Build ${{ matrix.arch }}
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      matrix:
        arch:
          - aarch64_generic

    permissions:
      actions: write
      contents: write
      pull-requests: write
      
    steps:
      - name: Checkout
        uses: actions/checkout@main
        with:
          fetch-depth: 0
      
      - name: Organize files
        run: |
          # 创建存放目录
          mkdir -p makeself
          
          echo "Hello, World!" > makeself/hello.run
          
          ls makeself
 
      - name: Commit files
        run: |
          git config --global user.name "GitHub Actions"
          git config --global user.email "uiouio_001@163.com"
          #添加.run文件到指定目录
          if [ "${{ matrix.arch }}" = "aarch64_generic" ]; then
            cp makeself/*.run run/arm64/
          else
            cp makeself/*.run run/x86/
          fi
          #添加到缓冲区
          git add -A
          #提交变更
          git commit -a -m "Add run files"
          #推送
          git push
          
